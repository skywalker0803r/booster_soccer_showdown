159 │   │   │   │   │   get_actions(obs, info) if get_actions else envs.action_space.sample(   │
│   160 │   │   │   │   )                                                                          │
│ ❱ 161 │   │   │   │   obs, rewards, terms, truns, info = envs.step(actions)                      │
│   162 │   │   │   │                                                                              │
│   163 │   │   │   │   was_alive = ~(terminated | truncated)                                      │
│   164                                                                                            │
│                                                                                                  │
│ ╭─────────────────────────────────────────── locals ───────────────────────────────────────────╮ │
│ │            actions = array([ -5.9816628,  -7.790432 , -19.94771  ,   5.920677 ,   5.600456 , │ │
│ │                      │   │   -3.5063467,  30.339981 ,   1.2097206,  -2.804306 , -15.733089 , │ │
│ │                      │   │   13.817024 ,   8.868229 ], dtype=float32)                        │ │
│ │      agg_durations = []                                                                      │ │
│ │         agg_scores = []                                                                      │ │
│ │      agg_timesteps = []                                                                      │ │
│ │              alive = array([ True,  True])                                                   │ │
│ │        all_actions = []                                                                      │ │
│ │          all_seeds = [2186790365970016330, 16885379353226687443]                             │ │
│ │      batch_actions = None                                                                    │ │
│ │          batch_idx = 0                                                                       │ │
│ │         batch_live = <rich.live.Live object at 0x7d12b2ad7cb0>                               │ │
│ │        batch_seeds = [2186790365970016330, 16885379353226687443]                             │ │
│ │         batch_size = 2                                                                       │ │
│ │   batch_start_time = 1763289764.035857                                                       │ │
│ │            console = <sai_rl.sai_console.SAIConsole object at 0x7d1438bad0a0>                │ │
│ │          cpu_count = 2                                                                       │ │
│ │ current_batch_size = 2                                                                       │ │
│ │               envs = AsyncVectorEnv(num_envs=2)                                              │ │
│ │                fps = 500                                                                     │ │
│ │               info = {                                                                       │ │
│ │                      │   'length': array([10.97, 10.97]),                                    │ │
│ │                      │   '_length': array([ True,  True]),                                   │ │
│ │                      │   'width': array([6.87, 6.87]),                                       │ │
│ │                      │   '_width': array([ True,  True]),                                    │ │
│ │                      │   'goal_width': array([1.6, 1.6]),                                    │ │
│ │                      │   '_goal_width': array([ True,  True]),                               │ │
│ │                      │   'goal_height': array([1.9, 1.9]),                                   │ │
│ │                      │   '_goal_height': array([ True,  True]),                              │ │
│ │                      │   'goal_depth': array([1.6, 1.6]),                                    │ │
│ │                      │   '_goal_depth': array([ True,  True]),                               │ │
│ │                      │   ... +42                                                             │ │
│ │                      }                                                                       │ │
│ │         is_windows = False                                                                   │ │
│ │        master_seed = 1832536064                                                              │ │
│ │        num_batches = 50                                                                      │ │
│ │           num_envs = 100                                                                     │ │
│ │                obs = array([[  0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  , │ │
│ │                      │   │     0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  , │ │
│ │                      │   │     0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  , │ │
│ │                      │   │     5.  ,   0.  ,  -0.7 ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  , │ │
│ │                      │   │     0.  ,  -5.97,   0.  ,  -0.7 , -10.97,   0.  ,   0.  ,  -5.97, │ │
│ │                      │   │     0.  ,  -0.5 ,   0.  ,   0.  ,   0.  ],                        │ │
│ │                      │      [  0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  , │ │
│ │                      │   │     0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  , │ │
│ │                      │   │     0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  , │ │
│ │                      │   │     5.  ,   0.  ,  -0.7 ,   0.  ,   0.  ,   0.  ,   0.  ,   0.  , │ │
│ │                      │   │     0.  ,  -5.97,   0.  ,  -0.7 , -10.97,   0.  ,   0.  ,  -5.97, │ │
│ │                      │   │     0.  ,  -0.5 ,   0.  ,   0.  ,   0.  ]], dtype=float32)        │ │
│ │            results = []                                                                      │ │
│ │       save_actions = False                                                                   │ │
│ │             scores = array([0., 0.])                                                         │ │
│ │               seed = None                                                                    │ │
│ │      show_progress = True                                                                    │ │
│ │             status = <sai_rl.sai_console.SAIStatus object at 0x7d12b2ad7560>                 │ │
│ │         terminated = array([False, False])                                                   │ │
│ │            timeout = 600                                                                     │ │
│ │   timeout_timestep = 300000                                                                  │ │
│ │           timestep = 0                                                                       │ │
│ │          timesteps = array([0, 0])                                                           │ │
│ │          truncated = array([False, False])                                                   │ │
│ ╰──────────────────────────────────────────────────────────────────────────────────────────────╯ │
│                                                                                                  │
│ /usr/local/lib/python3.12/dist-packages/gymnasium/vector/async_vector_env.py:388 in step         │
│                                                                                                  │
│   385 │   │   │   Batch of (observations, rewards, terminations, truncations, infos)             │
│   386 │   │   """                                                                                │
│   387 │   │   self.step_async(actions)                                                           │
│ ❱ 388 │   │   return self.step_wait()                                                            │
│   389 │                                                                                          │
│   390 │   def step_async(self, actions: np.ndarray):                                             │
│   391 │   │   """Send the calls to :meth:`Env.step` to each sub-environment.                     │
│                                                                                                  │
│ ╭───────────────────────────────────── locals ──────────────────────────────────────╮            │
│ │ actions = array([ -5.9816628,  -7.790432 , -19.94771  ,   5.920677 ,   5.600456 , │            │
│ │           │   │   -3.5063467,  30.339981 ,   1.2097206,  -2.804306 , -15.733089 , │            │
│ │           │   │   13.817024 ,   8.868229 ], dtype=float32)                        │            │
│ │    self = AsyncVectorEnv(num_envs=2)                                              │            │
│ ╰───────────────────────────────────────────────────────────────────────────────────╯            │
│                                                                                                  │
│ /usr/local/lib/python3.12/dist-packages/gymnasium/vector/async_vector_env.py:457 in step_wait    │
│                                                                                                  │
│   454 │   │   │   │   truncations.append(env_step_return[3])                                     │
│   455 │   │   │   │   infos = self._add_info(infos, env_step_return[4], env_idx)                 │
│   456 │   │                                                                                      │
│ ❱ 457 │   │   self._raise_if_errors(successes)                                                   │
│   458 │   │                                                                                      │
│   459 │   │   if not self.shared_memory:                                                         │
│   460 │   │   │   self.observations = concatenate(                                               │
│                                                                                                  │
│ ╭────────────────────────────────────── locals ──────────────────────────────────────╮           │
│ │         env_idx = 1                                                                │           │
│ │ env_step_return = None                                                             │           │
│ │           infos = {}                                                               │           │
│ │    observations = []                                                               │           │
│ │            pipe = <multiprocessing.connection.Connection object at 0x7d12b0f3e3c0> │           │
│ │         rewards = []                                                               │           │
│ │            self = AsyncVectorEnv(num_envs=2)                                       │           │
│ │         success = False                                                            │           │
│ │       successes = [False, False]                                                   │           │
│ │    terminations = []                                                               │           │
│ │         timeout = None                                                             │           │
│ │     truncations = []                                                               │           │
│ ╰────────────────────────────────────────────────────────────────────────────────────╯           │
│                                                                                                  │
│ /usr/local/lib/python3.12/dist-packages/gymnasium/vector/async_vector_env.py:711 in              │
│ _raise_if_errors                                                                                 │
│                                                                                                  │
│   708 │   │   │   if i == num_errors - 1:                                                        │
│   709 │   │   │   │   logger.error("Raising the last exception back to the main process.")       │
│   710 │   │   │   │   self._state = AsyncState.DEFAULT                                           │
│ ❱ 711 │   │   │   │   raise exctype(value)                                                       │
│   712 │                                                                                          │
│   713 │   def __del__(self):                                                                     │
│   714 │   │   """On deleting the object, checks that the vector environment is closed."""        │
│                                                                                                  │
│ ╭─────────────────────────────────────────── locals ───────────────────────────────────────────╮ │
│ │          i = 1                                                                               │ │
│ │      index = 1                                                                               │ │
│ │ num_errors = 2                                                                               │ │
│ │       self = AsyncVectorEnv(num_envs=2)                                                      │ │
│ │  successes = [False, False]                                                                  │ │
│ │      trace = 'Traceback (most recent call last):\n  File                                     │ │
│ │              "/usr/local/lib/python3.12/dist-packag'+1938                                    │ │
│ │      value = TypeError("object of type 'numpy.float32' has no len()")                        │ │
│ ╰──────────────────────────────────────────────────────────────────────────────────────────────╯ │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
TypeError: object of type 'numpy.float32' has no len()

The above exception was the direct cause of the following exception:

╭─────────────────────────────── Traceback (most recent call last) ────────────────────────────────╮
│ /content/booster_soccer_showdown/training_scripts/main_simple_dreamerv3.py:414 in <module>       │
│                                                                                                  │
│   411 print("=== Starting Evaluation ===")                                                       │
│   412                                                                                            │
│   413 ## Benchmark the model locally - use original model, let SAI handle everything             │
│ ❱ 414 sai.benchmark(model, action_function=action_function, preprocessor_class=Preprocessor, m   │
│   415                                                                                            │
│   416 ## Submit to leaderboard                                                                   │
│   417 print("=== Submitting to Leaderboard ===")                                                 │
│                                                                                                  │
│ ╭─────────────────────────────────────────── locals ───────────────────────────────────────────╮ │
│ │    cpu_model = <__main__.CPUModelWrapper object at 0x7d12c753ab70>                           │ │
│ │          env = <CustomEvaluationWrapper<TimeLimit<OrderEnforcing<PassiveEnvChecker<GoaliePe… │ │
│ │            F = <module 'torch.nn.functional' from                                            │ │
│ │                '/usr/local/lib/python3.12/dist-packages/torch/nn/functional.py'>             │ │
│ │        model = SimpleDreamerV3(                                                              │ │
│ │                  (rssm): RSSMCore(                                                           │ │
│ │                │   (obs_encoder): Sequential(                                                │ │
│ │                │     (0): Linear(in_features=89, out_features=256, bias=True)                │ │
│ │                │     (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (2): ReLU()                                                             │ │
│ │                │     (3): Linear(in_features=256, out_features=256, bias=True)               │ │
│ │                │     (4): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (5): ReLU()                                                             │ │
│ │                │   )                                                                         │ │
│ │                │   (rnn): GRUCell(268, 256)                                                  │ │
│ │                │   (prior_net): Linear(in_features=256, out_features=512, bias=True)         │ │
│ │                │   (posterior_net): Linear(in_features=512, out_features=512, bias=True)     │ │
│ │                │   (obs_decoder): Sequential(                                                │ │
│ │                │     (0): Linear(in_features=768, out_features=256, bias=True)               │ │
│ │                │     (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (2): ReLU()                                                             │ │
│ │                │     (3): Linear(in_features=256, out_features=256, bias=True)               │ │
│ │                │     (4): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (5): ReLU()                                                             │ │
│ │                │     (6): Linear(in_features=256, out_features=89, bias=True)                │ │
│ │                │   )                                                                         │ │
│ │                │   (reward_predictor): Sequential(                                           │ │
│ │                │     (0): Linear(in_features=768, out_features=128, bias=True)               │ │
│ │                │     (1): ReLU()                                                             │ │
│ │                │     (2): Linear(in_features=128, out_features=1, bias=True)                 │ │
│ │                │   )                                                                         │ │
│ │                  )                                                                           │ │
│ │                  (actor): Actor(                                                             │ │
│ │                │   (net): Sequential(                                                        │ │
│ │                │     (0): Linear(in_features=768, out_features=256, bias=True)               │ │
│ │                │     (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (2): ReLU()                                                             │ │
│ │                │     (3): Linear(in_features=256, out_features=256, bias=True)               │ │
│ │                │     (4): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (5): ReLU()                                                             │ │
│ │                │     (6): Linear(in_features=256, out_features=256, bias=True)               │ │
│ │                │     (7): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (8): ReLU()                                                             │ │
│ │                │     (9): Linear(in_features=256, out_features=12, bias=True)                │ │
│ │                │   )                                                                         │ │
│ │                  )                                                                           │ │
│ │                  (critic): Critic(                                                           │ │
│ │                │   (net): Sequential(                                                        │ │
│ │                │     (0): Linear(in_features=768, out_features=256, bias=True)               │ │
│ │                │     (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (2): ReLU()                                                             │ │
│ │                │     (3): Linear(in_features=256, out_features=256, bias=True)               │ │
│ │                │     (4): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (5): ReLU()                                                             │ │
│ │                │     (6): Linear(in_features=256, out_features=256, bias=True)               │ │
│ │                │     (7): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (8): ReLU()                                                             │ │
│ │                │     (9): Linear(in_features=256, out_features=1, bias=True)                 │ │
│ │                │   )                                                                         │ │
│ │                  )                                                                           │ │
│ │                  (target_critic): Critic(                                                    │ │
│ │                │   (net): Sequential(                                                        │ │
│ │                │     (0): Linear(in_features=768, out_features=256, bias=True)               │ │
│ │                │     (1): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (2): ReLU()                                                             │ │
│ │                │     (3): Linear(in_features=256, out_features=256, bias=True)               │ │
│ │                │     (4): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (5): ReLU()                                                             │ │
│ │                │     (6): Linear(in_features=256, out_features=256, bias=True)               │ │
│ │                │     (7): LayerNorm((256,), eps=1e-05, elementwise_affine=True)              │ │
│ │                │     (8): ReLU()                                                             │ │
│ │                │     (9): Linear(in_features=256, out_features=1, bias=True)                 │ │
│ │                │   )                                                                         │ │
│ │                  )                                                                           │ │
│ │                )                                                                             │ │
│ │           np = <module 'numpy' from                                                          │ │
│ │                '/usr/local/lib/python3.12/dist-packages/numpy/__init__.py'>                  │ │
│ │           os = <module 'os' (frozen)>                                                        │ │
│ │ preprocessor = <__main__.Preprocessor object at 0x7d12b2aa3860>                              │ │
│ │       random = <module 'random' from '/usr/lib/python3.12/random.py'>                        │ │
│ │          sai = <sai_rl.sai_client.SAIClient object at 0x7d135247c530>                        │ │
│ │        torch = <module 'torch' from                                                          │ │
│ │                '/usr/local/lib/python3.12/dist-packages/torch/__init__.py'>                  │ │
│ ╰──────────────────────────────────────────────────────────────────────────────────────────────╯ │
│                                                                                                  │
│ /usr/local/lib/python3.12/dist-packages/sai_rl/sai_client.py:818 in benchmark                    │
│                                                                                                  │
│    815 │   │   │   results["duration"] = time.time() - start_time                                │
│    816 │   │   │                                                                                 │
│    817 │   │   │   if error and throw_errors:                                                    │
│ ❱  818 │   │   │   │   raise error                                                               │
│    819 │   │   │                                                                                 │
│    820 │   │   │   if self._log_capture:                                                         │
│    821 │   │   │   │   results["logs"] = self._get_logs()                                        │
│                                                                                           