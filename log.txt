✓ Successfully loaded model.

╭─────────────────────────────── Evaluation Progress (Batch 50/50) ────────────────────────────────╮
│           ┏━━━━━━━┳━━━━━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━━━━━┳━━━━━━━┳━━━━━━┳━━━━━━━━━━━┓           │
│           ┃ Steps ┃ Finished Envs ┃ Completed ┃ Avg Score ┃  FPS  ┃ Time ┃ Remaining ┃           │
│           ┡━━━━━━━╇━━━━━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━━━━━╇━━━━━━━╇━━━━━━╇━━━━━━━━━━━┩           │
│           │  334  │      2/2      │  100.0%   │   -0.30   │ 233.0 │ 1.4s │   0.0s    │           │
│           └───────┴───────────────┴───────────┴───────────┴───────┴──────┴───────────┘           │
╰────────────────────────────────────────── 100/100 envs ──────────────────────────────────────────╯

✓ Evaluation completed successfully

=== Submitting to Leaderboard ===
NOTE: This competition uses a custom evaluation, by setting 'use_custom_eval=False', the rewards will not match the server's evaluation.

╭─ Preprocessing class ────────────────────────────────────────────────────────────────────────────╮
│                                                                                                  │
│  class Preprocessor():                                                                           │
│                                                                                                  │
│      def get_task_onehot(self, info):                                                            │
│          if 'task_index' in info:                                                                │
│              return info['task_index']                                                           │
│          else:                                                                                   │
│              return np.array([])                                                                 │
│                                                                                                  │
│      def quat_rotate_inverse(self, q: np.ndarray, v: np.ndarray):                                │
│          q_w = q[:,[-1]]                                                                         │
│          q_vec = q[:,:3]                                                                         │
│          a = v * (2.0 * q_w**2 - 1.0)                                                            │
│          b = np.cross(q_vec, v) * (q_w * 2.0)                                                    │
│          c = q_vec * (np.dot(q_vec, v).reshape(-1,1) * 2.0)                                      │
│          return a - b + c                                                                        │
│                                                                                                  │
│      def modify_state(self, obs, info):                                                          │
│                                                                                                  │
│          if len(obs.shape) == 1:                                                                 │
│              obs = np.expand_dims(obs, axis=0)                                                   │
│                                                                                                  │
│          task_onehot = self.get_task_onehot(info)                                                │
│          if len(task_onehot.shape) == 1:                                                         │
│              task_onehot = np.expand_dims(task_onehot, axis=0)                                   │
│                                                                                                  │
│          if len(info["robot_quat"].shape) == 1:                                                  │
│              info["robot_quat"] = np.expand_dims(info["robot_quat"], axis = 0)                   │
│              info["robot_gyro"] = np.expand_dims(info["robot_gyro"], axis = 0)                   │
│              info["robot_accelerometer"] = np.expand_dims(info["robot_accelerometer"], axis = 0  │
│              info["robot_velocimeter"] = np.expand_dims(info["robot_velocimeter"], axis = 0)     │
│              info["goal_team_0_rel_robot"] = np.expand_dims(info["goal_team_0_rel_robot"], axis  │
│              info["goal_team_1_rel_robot"] = np.expand_dims(info["goal_team_1_rel_robot"], axis  │
│              info["goal_team_0_rel_ball"] = np.expand_dims(info["goal_team_0_rel_ball"], axis =  │
│              info["goal_team_1_rel_ball"] = np.expand_dims(info["goal_team_1_rel_ball"], axis =  │
│              info["ball_xpos_rel_robot"] = np.expand_dims(info["ball_xpos_rel_robot"], axis = 0  │
│              info["ball_velp_rel_robot"] = np.expand_dims(info["ball_velp_rel_robot"], axis = 0  │
│              info["ball_velr_rel_robot"] = np.expand_dims(info["ball_velr_rel_robot"], axis = 0  │
│              info["player_team"] = np.expand_dims(info["player_team"], axis = 0)                 │
│              info["goalkeeper_team_0_xpos_rel_robot"] = np.expand_dims(info["goalkeeper_team_0_  │
│              info["goalkeeper_team_0_velp_rel_robot"] = np.expand_dims(info["goalkeeper_team_0_  │
│              info["goalkeeper_team_1_xpos_rel_robot"] = np.expand_dims(info["goalkeeper_team_1_  │
│              info["goalkeeper_team_1_velp_rel_robot"] = np.expand_dims(info["goalkeeper_team_1_  │
│              info["target_xpos_rel_robot"] = np.expand_dims(info["target_xpos_rel_robot"], axis  │
│              info["target_velp_rel_robot"] = np.expand_dims(info["target_velp_rel_robot"], axis  │
│              info["defender_xpos"] = np.expand_dims(info["defender_xpos"], axis = 0)             │
│                                                                                                  │
│          robot_qpos = obs[:,:12]                                                                 │
│          robot_qvel = obs[:,12:24]                                                               │
│          quat = info["robot_quat"]                                                               │
│          base_ang_vel = info["robot_gyro"]                                                       │
│          project_gravity = self.quat_rotate_inverse(quat, np.array([0.0, 0.0, -1.0]))            │
│                                                                                                  │
│          obs = np.hstack((robot_qpos,                                                            │
│                           robot_qvel,                                                            │
│                           project_gravity,                                                       │
│                           base_ang_vel,                                                          │
│                           info["robot_accelerometer"],                                           │
│                           info["robot_velocimeter"],                                             │
│                           info["goal_team_0_rel_robot"],                                         │
│                           info["goal_team_1_rel_robot"],                                         │
│                           info["goal_team_0_rel_ball"],                                          │
│                           info["goal_team_1_rel_ball"],                                          │
│                           info["ball_xpos_rel_robot"],                                           │
│                           info["ball_velp_rel_robot"],                                           │
│                           info["ball_velr_rel_robot"],                                           │
│                           info["player_team"],                                                   │
│                           info["goalkeeper_team_0_xpos_rel_robot"],                              │
│                           info["goalkeeper_team_0_velp_rel_robot"],                              │
│                           info["goalkeeper_team_1_xpos_rel_robot"],                              │
│                           info["goalkeeper_team_1_velp_rel_robot"],                              │
│                           info["target_xpos_rel_robot"],                                         │
│                           info["target_velp_rel_robot"],                                         │
│                           info["defender_xpos"],                                                 │
│                           task_onehot))                                                          │
│                                                                                                  │
│          return obs                                                                              │
│                                                                                                  │
│                                                                                                  │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
✓ Successfully loaded preprocessing class.

╭─ Action function ────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                  │
│  def action_function(policy):                                                                    │
│      expected_bounds = [-1, 1]                                                                   │
│      action_percent = (policy - expected_bounds[0]) / (                                          │
│          expected_bounds[1] - expected_bounds[0]                                                 │
│      )                                                                                           │
│      bounded_percent = np.minimum(np.maximum(action_percent, 0), 1)                              │
│      return (                                                                                    │
│          env.action_space.low                                                                    │
│          + (env.action_space.high - env.action_space.low) * bounded_percent                      │
│      )                                                                                           │
│                                                                                                  │
│                                                                                                  │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
✓ Successfully loaded action function.

╭─ Model ──────────────────────────────────────────────────────────────────────────────────────────╮
│                                                                                                  │
│  Type:          pytorch                                                                          │
│  Environment:    LowerT1GoaliePenaltyKick-v0                                                     │
│  Preprocess Function:  Custom                                                                    │
│  Action Function:  Custom                                                                        │
│                                                                                                  │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
✓ Successfully loaded model.

╭─ "Vedanta_SimpleDreamerV3" Submission Details ───────────────────────────────────────────────────╮
│                                                                                                  │
│  Competition ID:      cmp_xnSCxcJXQclQ                                                           │
│  Competition Name:    Booster Soccer Showdown                                                    │
│  Model Type:          pytorch                                                                    │
│  Preprocess Function:  Custom                                                                    │
│  Action Function:  Custom                                                                        │
╰──────────────────────────────────────────────────────────────────────────────────────────────────╯
/content/booster_soccer_showdown/training_scripts/sai_compatible_dreamerv3.py:35: TracerWarning: Converting a tensor to a Python boolean might cause the trace to be 
incorrect. We can't record the data flow of Python values, so this value will be treated as a constant in the future. This means that the trace might not generalize to other
inputs!
  if x.shape[-1] != self.dreamer.obs_dim:
/usr/local/lib/python3.12/dist-packages/torch/jit/_trace.py:1310: TracerWarning: Trace had nondeterministic nodes. Did you forget call .eval() on your model? Nodes:
        %375 : Long(32, 1, strides=[1, 1], requires_grad=0, device=cpu) = aten::multinomial(%probs_2d, %372, %373, %374) # 
/usr/local/lib/python3.12/dist-packages/torch/distributions/categorical.py:143:0
This may cause errors in trace checking. To disable trace checking, pass check_trace=False to torch.jit.trace()
  _check_trace(
/usr/local/lib/python3.12/dist-packages/torch/jit/_trace.py:1310: TracerWarning: Output nr 1. of the traced function does not match the corresponding output of the Python 
function. Detailed error:
Tensor-likes are not close!

Mismatched elements: 12 / 12 (100.0%)
Greatest absolute difference: 0.4995700344443321 at index (0, 5) (up to 1e-05 allowed)
Greatest relative difference: 9.165095626880191 at index (0, 4) (up to 1e-05 allowed)
  _check_trace(
✓ Model submitted successfully.
=== Complete ===
/content/booster_soccer_showdown# 