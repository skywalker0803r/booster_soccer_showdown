â”‚ /content/booster_soccer_showdown/Research/main.py:161 in pretrain_sb3_model                      â”‚
â”‚                                                                                                  â”‚
â”‚   158 â”‚   â”‚   â”‚   â”‚   with torch.no_grad():                                                      â”‚
â”‚   159 â”‚   â”‚   â”‚   â”‚   â”‚   # è‡¨æ™‚è¨­ç½®ç‚ºè©•ä¼°æ¨¡å¼ä»¥ç²å–ç¢ºå®šæ€§å‹•ä½œ                                   â”‚
â”‚   160 â”‚   â”‚   â”‚   â”‚   â”‚   policy.set_training_mode(False)                                        â”‚
â”‚ â± 161 â”‚   â”‚   â”‚   â”‚   â”‚   actions_tensor = policy.predict(batch_obs, deterministic=True)[0]      â”‚
â”‚   162 â”‚   â”‚   â”‚   â”‚   â”‚   actions_mean = torch.tensor(actions_tensor, device=batch_obs.device,   â”‚
â”‚   163 â”‚   â”‚   â”‚   â”‚   â”‚   policy.set_training_mode(True)                                         â”‚
â”‚   164  

TypeError: can't convert cuda:0 device type tensor to numpy. Use Tensor.cpu() to copy the tensor to host memory first.
/content/booster_soccer_showdown/Research# 

â•­â”€ Response â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â•®
â”‚ å®Œç¾ï¼ç¾åœ¨æ•¸æ“šé¡å‹è½‰æ›å•é¡Œå·²ç¶“è§£æ±ºäº†ï¼ğŸ‰                                                                             â”‚
â”‚                                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚                                                     âœ… ä¿®æ­£å®Œæˆ                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚                                                       å•é¡Œæ ¹æº                                                       â”‚
â”‚                                                                                                                      â”‚
â”‚  â€¢ SB3çš„ policy.predict() åªæ¥å— numpy array è¼¸å…¥                                                                    â”‚
â”‚  â€¢ æˆ‘å€‘çš„æ•¸æ“šæ˜¯ CUDA tensorï¼Œç„¡æ³•ç›´æ¥ä½¿ç”¨                                                                            â”‚
â”‚                                                                                                                      â”‚
â”‚                                                       è§£æ±ºæ–¹æ¡ˆ                                                       â”‚
â”‚                                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚  # 1. å°‡CUDA tensorè½‰ç‚ºnumpy                                                                                         â”‚
â”‚  batch_obs_np = batch_obs.cpu().numpy()                                                                              â”‚
â”‚                                                                                                                      â”‚
â”‚  # 2. ä½¿ç”¨SB3é æ¸¬ (è¿”å›numpy)                                                                                        â”‚
â”‚  actions_np, _ = policy.predict(batch_obs_np, deterministic=True)                                                    â”‚
â”‚                                                                                                                      â”‚
â”‚  # 3. è½‰å›CUDA tensorç”¨æ–¼æ¢¯åº¦è¨ˆç®—                                                                                    â”‚
â”‚  predicted_actions = torch.tensor(actions_np, device=batch_obs.device, dtype=torch.float32, requires_grad=True)      â”‚
â”‚                                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚                                                       æ•¸æ“šæµè½‰                                                       â”‚
â”‚                                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚  CUDA tensor â†’ CPU numpy â†’ SB3 predict â†’ numpy â†’ CUDA tensor â†’ æ¢¯åº¦è¨ˆç®—                                              â”‚
â”‚                                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚                                                ğŸš€ ç¾åœ¨å¯ä»¥æ­£å¸¸é‹è¡Œäº†                                                 â”‚
â”‚                                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚  cd Research                                                                                                         â”‚
â”‚  python main.py                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚                                                                                                                      â”‚
â”‚                                                       é æœŸæµç¨‹                                                       â”‚
â”‚                                                                                                                      â”‚
â”‚  1 âœ… ç’°å¢ƒå‰µå»º                                                                                                       â”‚
â”‚  2 âœ… SB3æ¨¡å‹å‰µå»º                                                                                                    â”‚
â”‚  3 âœ… BCé è¨“ç·´é–‹å§‹ (ç„¡ç¶­åº¦éŒ¯èª¤)                                                                                      â”‚
â”‚  4 âœ… æ•¸æ“šé¡å‹è½‰æ›æ­£ç¢º                                                                                               â”‚
â”‚  5 âœ… æ¢¯åº¦è¨ˆç®—å’Œåå‘å‚³æ’­æ­£å¸¸                                                                                         â”‚
â”‚  6 âœ… BCé è¨“ç·´å®Œæˆ                                                                                                   â”‚
â”‚  7 âœ… SB3 PPOè¨“ç·´é–‹å§‹                                                                                                â”‚
â”‚                                                                                                                      â”‚
â”‚ æ‚¨çš„BCé è¨“ç·´ + SB3 PPOç³»çµ±ç¾åœ¨æ‡‰è©²èƒ½å®Œç¾é‹è¡Œäº†ï¼æ‰€æœ‰APIå’Œæ•¸æ“šé¡å‹å•é¡Œéƒ½å·²è§£æ±ºï¼ ğŸ¯